<!-- <!DOCTYPE html>
<html>

<head>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson@3"></script>
<style>
  .hidden {
  display: none;
}

div.tooltip {
  background-color: #fff;
  padding: 7px;
  text-shadow: #f5f5f5 0 1px 0;
  font: 15px Helvetica Neue;
  border: 2.5px solid;
  border-color: black;
	border-radius: 3px;
  opacity: 0.95;
  position: absolute;
  box-shadow: rgba(0, 0, 0, 0.3) 0 2px 10px;
}

.country-boundary {
  fill: #ccc;
  stroke: #999;
  stroke-width: .25px;
}
</style>
</head>

<body>
  <p>
    Hello!
  </p>
</body>
<div id="myMap"></div>
<script>
  var width = 900;
  var height = 600;

  // var tooltip = d3.select("body")
  //   .append("div")
  //   .style("opacity", 0)
  //   .style("position", "absolute")
  //   .style("z-index", "10")
  //   .attr("class", "tooltip")
  //   .style("background-color", "white")
  //   .style("border", "solid")
  //   .style("border-width", "2px")
  //   .style("border-radius", "5px")
  //   .style("padding", "5px")

  // // Three function that change the tooltip when user hover / move / leave a cell
  // var mouseover = function (d) {
  //   tooltip
  //     .style("opacity", 1)
  //   d3.select(this)
  //     .style("stroke", "black")
  //     .style("opacity", 1)
  // }
  // var mousemove = (event, d) => {
  //   const [x, y] = d3.pointer(event);

  //   tooltip
  //     // .style('transform', `translate(${x}, ${y})`);
  //     .style("left", (x + "px"))
  //     .style("top", (y + "px"))
  //   // .style("left", (d3.event.pageX + "px"))
  //   // .style("top", (d3.event.pageY + "px"))
  // }
  // var mouseout = function (d) {
  //   tooltip
  //     .style("opacity", 0)
  //   d3.select(this)
  //     .style("stroke", "#999")
  //     .style("opacity", 0.8)
  // }

  // const svg = d3.select('#myMap').append('svg')
  //   .style('position', 'absolute')
  //   .attr("viewBox", [0, 0, width, height]);


  // const projection = d3.geoMercator().scale(140)
  //   .translate([width / 2, height / 1.4]);
  // const path = d3.geoPath(projection);


  // const g = svg.append('g')


  // d3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json')
  //   .then(data => {

  //     const countries = topojson.feature(data, data.objects.countries);
  //     var country = g.selectAll('path').data(countries.features).enter()
  //     country.append('path')
  //       .attr('class', 'country')
  //       .attr('d', path)
  //       .style('fill', '#ccc')
  //       .style('stroke', '#999')
  //       .style('opacity', '0.8')
  //       .on("mouseover", mouseover)
  //       .on("mousemove", mousemove)
  //       .on("mouseout", mouseout)
  //       .append("title")
  //     .text((d, i) => `circle ${i}`);


  //   });


  
  const zoom = d3.zoom()
      .scaleExtent([1/4, 9])
      .on('zoom', function () {
        d3.select('g').attr('transform', d3.event.transform)
      });
  
  var svg = d3.select('#myMap')
      .append('svg')
      .attr('width', width)
      .attr('height', height)
      .call(zoom);
  
  var g = svg.append('g');
  
  var tooltip = d3.select('#myMap').append('div')
    .attr('class', 'hidden tooltip');
  
  var projection = d3.geoMercator()
    .rotate([-109.5, -4])
    .scale(2700);
 
  var path = d3.geoPath()
      .projection(projection);

  d3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json', function(error, data) {
  	if (error) throw error;

        g.selectAll("path")
    	  .data(topojson.feature(data, data.objects.countries))
		    .enter()
		    .append("path")
    	  .attr("d", path)
        .attr("class", "country-boundary")
        .on('mousemove', function (d) {
          tooltip.classed('hidden', false)
            .attr('style', 'left:' + (d3.event.clientX + 20) + 'px; top:' + (d3.event.clientY - 20) + 'px')
            .html(d.properties.DISTRICT);
        })
        .on('mouseout', function () {
          tooltip.classed('hidden', true);
        });

    // g.selectAll(".states")
    // 	  .data(topojson.feature(data, data.objects.states).features)
		//     .enter()
		//     .append("path")
    // 	  .attr("d", path)
    //     .attr("class", "state-boundary");
	});

</script>

</html> -->


<!DOCTYPE html>
<meta charset="utf-8">

<head>
  <style>
    #wrapper {
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .state-boundary {
      fill: none;
      stroke: #fff;
      stroke-width: 0.8px;
    }

    .district-boundary {
      fill: #ccc;
      stroke: #999;
      stroke-width: .3px;
      opacity: 0.8;
    }

    .hidden {
      display: none;
    }

    div.tooltip {
      background-color: #fff;
      padding: 7px;
      text-shadow: #f5f5f5 0 1px 0;
      font: 13px Helvetica Neue;
      border: 2.5px solid;
      border-color: black;
      border-radius: 3px;
      opacity: 0.95;
      position: absolute;
      box-shadow: rgba(0, 0, 0, 0.3) 0 2px 10px;
    }
  </style>
</head>

<body>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson@3"></script>

  <div id="wrapper">
    <div id="chart"></div>
  </div>

  <script>

    var width = 960,
      height = 600;

    // const zoom = d3.zoom()
    //   .scaleExtent([1 / 4, 9])
    //   .on('zoom', function (event) {
    //     d3.select('g').attr('transform', d3.event.transform)
    //   });
    function zoomed({ transform }) {
      d3.select('g').attr("transform", transform);
    }
    const zoom = d3.zoom()
      // .extent([[0, 0], [width, height]])
      .scaleExtent([1 / 4, 9])
      .on("zoom", zoomed)

    var svg = d3.select('#chart')
      .append('svg')
      .attr('width', width)
      .attr('height', height)
      .call(zoom);

    var g = svg.append('g');



    var tooltip = d3.select('#chart').append('div')
      .attr('class', 'hidden tooltip');

    const projection = d3.geoMercator()
      .scale(140)
      .translate([width / 2, height / 1.4]);

    var path = d3.geoPath()
      .projection(projection);

    var mouseover = function (d) {
      tooltip.classed('hidden', false);
      d3.select(this)
        .style("stroke", "black")
        .style("opacity", 1)
    }
    var mousemove = (event, d) => {
          tooltip
            .attr('style', 'left:' + (event.clientX + 20) + 'px; top:' + (event.clientY - 10) + 'px')
            .html(d.properties.name + '<br>' + d.properties.test);
        }

    var mouseout = function (d) {
      tooltip.classed('hidden', true);
      d3.select(this)
        .style("stroke", "#999")
        .style("opacity", 0.8)
    }

    d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then((data) => {
      // if (error) throw error;

      // d3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json')
      //   .then(data => {

      //     const countries = topojson.feature(data, data.objects.countries);
      //     var country = g.selectAll('path').data(countries.features).enter()
      //     country.append('path')
      //       .attr('class', 'country')
      //       .attr('d', path)
      //       .style('fill', '#ccc')
      //       .style('stroke', '#999')
      //       .style('opacity', '0.8')
      //       .on("mouseover", mouseover)
      //       .on("mousemove", mousemove)
      //       .on("mouseout", mouseout)
      //       .append("title")
      //     .text((d, i) => `circle ${i}`);
      var features = topojson.feature(data, data.objects.countries).features
      console.log(features)
      features.forEach((element,index) => {
        element.properties = {
          ...element.properties,
          test: index
        }
      });
      console.log(features)


      g.selectAll("path")
        .data(features)
        .enter()
        .append("path")
        .attr("d", path)
        .attr("class", "district-boundary")
        .on('mouseover', mouseover)
        .on('mousemove', mousemove)
        .on('mouseout', mouseout);

      // g.selectAll(".states")
      //   .data(topojson.feature(state_districts, state_districts.objects.states).features)
      //   .enter()
      //   .append("path")
      //   .attr("d", path)
      //   .attr("class", "state-boundary");
    });
  </script>
</body>